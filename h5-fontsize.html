<script>
  function setRootPixel() {
    // var defaultFontSize = 0;

    // TODO 确认
    // function getDefaultFontSize() {
    //     if (defaultFontSize) {
    //         return defaultFontSize;
    //     }

    //     document.documentElement.style.fontSize = '';
    //     var temp = document.createElement('div');
    //     temp.style.cssText = 'width:1rem;display:none';
    //     document.head.appendChild(temp);
    //     defaultFontSize =
    //         +window.getComputedStyle(temp, null).getPropertyValue('width').replace('px', '') || 16;
    //     document.head.removeChild(temp);

    //     return defaultFontSize;
    // }
    function setRootFontSize() {
      var rem2px = 50;
      var clientWidth =
        window.innerWidth && document.documentElement.clientWidth
          ? Math.min(window.innerWidth, document.documentElement.clientWidth)
          : window.innerWidth ||
            document.documentElement.clientWidth ||
            (document.body && document.body.clientWidth) ||
            375;

      var htmlFontSizePx = (clientWidth / 375) * rem2px;

      var defaultFontSize = 16;

      var htmlEl = document.querySelector("html");
      if (htmlEl) {
        htmlEl.style.fontSize = (htmlFontSizePx / defaultFontSize) * 100 + "%";
      }
      // 获取真实值
      // fixed Galaxy S10，html实际字体大小与设置不一致
      window.htmlFontSize =
        Number(
          window
            .getComputedStyle(document.documentElement)
            .fontSize.slice(0, -2)
        ) || htmlFontSizePx;
    }

    function adjust(immediate) {
      if (immediate) {
        setRootFontSize();
        return;
      }

      setTimeout(setRootFontSize, 30);
    }

    adjust(true);

    window.addEventListener("resize", adjust, false);

    if ("onorientationchange" in window) {
      window.addEventListener("orientationchange", adjust, false);
    }
  }

  setRootPixel();
</script>
